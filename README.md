# Slack Reaction Tool (Chrome Extension)

## 目的

ユーザーが自分のSlack OAuthアクセストークンを入力し、メッセージに絵文字リアクションを自分として追加できるChrome拡張機能です。

Slackボットや管理者権限は不要です。

MVPはシンプルで最小限に保ちます。

UI/UXはSlackのデザイン原則（スペーシング、色、ボタンなど）に従います。

## 主要機能

### 手動リアクション追加
- ユーザーがOAuthアクセストークンを入力するフォーム
- チャンネルID、メッセージタイムスタンプ（TS）、絵文字名を指定するフィールド
- 「リアクション追加」ボタンでAPI呼び出しを実行
- シンプルな結果表示（成功またはエラー）
- **現在のメッセージ情報を取得**ボタンでSlackページから自動取得

### 自動スタンプ機能（Fake Stamper Bot）
- **自動モードトグル**: オン/オフで自動機能を制御
- **リアルタイム監視**: 60秒間隔でメッセージをポーリング
- **ルールベース自動反応**: 事前定義されたルールに基づく自動リアクション
  - `@all`/`@channel` → 注意喚起系絵文字（:eyes:, :alert:, :loudspeaker:）
  - ポジティブキーワード → ポジティブ系絵文字（:clap:, :pray:, :thumbsup:）
- **ランダム遅延**: 5-15分のランダムな遅延後にリアクション送信
- **重複防止**: 同じメッセージには1回のみ反応
- **自己反応防止**: 自分のメッセージには反応しない

## Chrome拡張機能の利点

- **CORS制限回避**: ブラウザのセキュリティ制限を回避
- **自動メッセージ情報取得**: Slackページから直接情報を取得
- **バックグラウンド動作**: 自動機能がバックグラウンドで継続動作
- **安全なトークン保存**: Chromeストレージで安全にトークンを保存
- **Slackページ統合**: Slackページで直接使用可能

## インストール方法

### 開発版インストール

1. **プロジェクトをビルド**
   ```bash
   npm install
   npm run build:extension
   ```

2. **Chrome拡張機能ページを開く**
   - Chromeで `chrome://extensions/` にアクセス

3. **デベロッパーモードを有効化**
   - 右上の「デベロッパーモード」トグルをオン

4. **拡張機能を読み込み**
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - プロジェクトの `dist` フォルダを選択

5. **使用開始**
   - Slackページで拡張機能アイコンをクリック

## 使用方法

### 手動リアクション追加
1. Slack OAuthアクセストークンを取得
2. Slackページで拡張機能を開く
3. 「現在のメッセージ情報を取得」ボタンをクリック（推奨）
4. または手動でチャンネルID、メッセージTS、絵文字名を入力
5. 「リアクション追加」ボタンをクリック

### 自動スタンプ機能
1. OAuthアクセストークンを入力
2. 自動モードをオンに切り替え
3. 拡張機能がバックグラウンドで自動的にメッセージを監視

## 技術要件

- Chrome拡張機能（Manifest V3）
- React + Vite
- Tailwind CSSでSlackデザインを実現
- Content Scripts + Background Scripts
- Chrome Storage API
- Slack API: reactions.add, conversations.history, auth.test

## 必要な権限

- `storage` - 設定とトークンの保存
- `activeTab` - 現在のタブへのアクセス
- `scripting` - スクリプト実行
- `https://*.slack.com/*` - Slackページへのアクセス

## アーキテクチャ

### Chrome拡張機能構成
- **Popup**: Reactアプリケーション（メインUI）
- **Content Script**: Slackページでのメッセージ情報取得
- **Background Script**: API呼び出しと自動スタンプ機能
- **Manifest**: 拡張機能の設定と権限

### データフロー
1. Popup → Background Script → Slack API
2. Content Script → Popup（メッセージ情報）
3. Background Script → 自動ポーリング → Slack API

## セキュリティ

- トークンはChromeストレージに安全に保存
- すべての処理はローカルで実行
- 外部サーバーにデータを送信しません
- CORS制限を回避して安全にAPI呼び出し

## 開発

```bash
# 開発サーバー起動
npm run dev

# 拡張機能ビルド
npm run build:extension

# リント
npm run lint
```

## トラブルシューティング

### 拡張機能が動作しない場合
1. Chrome拡張機能ページで拡張機能が有効になっているか確認
2. Slackページで拡張機能を使用しているか確認
3. デベロッパーツールのコンソールでエラーメッセージを確認

### APIエラーが発生する場合
1. OAuthトークンが正しく設定されているか確認
2. 必要な権限（reactions:write）が付与されているか確認
3. チャンネルIDとメッセージTSが正しいか確認 